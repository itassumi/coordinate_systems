```markdown
# Обробка координатних даних: Придушення шумів у потоці (Real-time)

## Реалізація

### Код фільтрів:

#### SMA Filter:
```python
def update(self, x):
    if len(self.q) == self.w:
        old = self.q[0]
        self.sum -= old
    
    self.q.append(x)
    self.sum += x
    
    return self.sum / len(self.q)
```

#### EMA Filter:
```python
def update(self, x):
    if self.last is None:
        self.last = x
    else:
        self.last = self.a * x + (1 - self.a) * self.last
    
    return self.last
```

#### Median Filter:
```python
def update(self, x):
    self.q.append(x)
    return np.median(list(self.q))
```

---

## Експеримент 1 (Базовий)

### Параметри:
- W_SMA = 20
- A_EMA = 0.1
- W_MED = 21

### Графіки:
![Експеримент 1.1](https://github.com/itassumi/coordinate_systems/blob/f5f5d5fab7ce2cc1b977d18482aa9579160aca9a/4/1.1.png)
![Експеримент 1.2](https://github.com/itassumi/coordinate_systems/blob/f5f5d5fab7ce2cc1b977d18482aa9579160aca9a/4/1.2.png)

### Відповіді на питання:
1. **Чи сильно лінії фільтрів відстають від ідеалу?**
   - SMA: помірне відставання (~0.5-1 секунда)
   - EMA: найменше відставання серед усіх фільтрів
   - Median: найбільше відставання через властивості медіани

2. **Як медіанний фільтр впорався з викидами порівняно з SMA?**
   - Median фільтр повністю ігнорує поодинокі викиди
   - SMA лише зменшує амплітуду викидів
   - На графіку Y(t) Median проходить точно по ідеальній траєкторії, не реагуючи на піки

---

## Експеримент 2 (Екстремальний)

### Параметри:
- W_SMA = 100
- A_EMA = 0.02
- W_MED = 21

### Графіки:
![Експеримент 2.1](https://github.com/itassumi/coordinate_systems/blob/f5f5d5fab7ce2cc1b977d18482aa9579160aca9a/4/2.1.png)
![Експеримент 2.2](https://github.com/itassumi/coordinate_systems/blob/f5f5d5fab7ce2cc1b977d18482aa9579160aca9a/4/2.2.png)

### Пояснення парадоксу спектру помилки:

**Спостереження:** На графіку спектру помилки Y (0-1 Гц) помилка фільтрів стала вищою за вхідний шум.

**Пояснення:**
1. При екстремальному згладжуванні фільтри стають надто "інерційними"
2. Вони не встигають реагувати на швидкі зміни істинного сигналу
3. Виникає спотворення форми сигналу ("зрізання кутів")
4. Це спотворення має низькочастотний характер
5. В результаті: замість шуму отримуємо систематичну помилку

---

## Експеримент 3 (Малий медіан)

### Параметри:
- W_SMA = 20
- A_EMA = 0.1
- W_MED = 5

### Графіки:
![Експеримент 3.1](https://github.com/itassumi/coordinate_systems/blob/f5f5d5fab7ce2cc1b977d18482aa9579160aca9a/4/3.1.png)
![Експеримент 3.2](https://github.com/itassumi/coordinate_systems/blob/f5f5d5fab7ce2cc1b977d18482aa9579160aca9a/4/3.2.png)

### Аналіз:
- Малий медіанний фільтр (W=5) добре видаляє поодинокі викиди
- Тривалі викиди все ще проходять через фільтр
- Порівняно з SMA (W=20) має меншу затримку, але й меншу гладкість
- На спектрі помилки видно покращення на високих частотах

---

## Висновок

### Для видалення збоїв сенсора (викидів):
**Кращий фільтр: Медіанний**
- Повністю ігнорує викиди
- Не потребує тонкого налаштування
- Особливо ефективний при невеликому вікні (5-11 точок)

### Для плавного ведення траєкторії:
**Кращий фільтр: EMA**
- Найменша затримка
- Плавна реакція на зміни
- Мінімальні спотворення форми сигналу

### Компроміс:
- **SMA:** Хороший баланс між якістю та затримкою
- **EMA:** Краща динаміка, гірше придушення викидів  
- **Median:** Краща захищеність від викидів, більша затримка

Вибір фільтра залежить від конкретної задачі та пріоритетів системи. Для реальних застосувань рекомендується комбінація фільтрів або адаптивний підхід.
